@{
    ViewData["Title"] = "Secure";
}


<h1>Current User Claims</h1>
@foreach (var id in User.Identities)
{
    <h3>Scheme: @id.AuthenticationType</h3>
    <dl>
        @foreach (var claim in id.Claims)
        {
            <dt>@claim.Type</dt>
            <dd>@claim.Value</dd>
        }
    </dl>
}

@if (Model != null)
{
    <h1>Policy Results</h1>
    @if (Model.Roles.Any())
    {
        <h2>Roles</h2>
        <ul>
            @foreach (var role in Model.Roles)
            {
                <li>@role</li>
            }
        </ul>
    }

    @if (Model.Permissions.Any())
    {
        <h2>Permission</h2>
        <ul>
            @foreach (var perm in Model.Permissions)
            {
                <li>@perm</li>
            }
        </ul>
    }
}